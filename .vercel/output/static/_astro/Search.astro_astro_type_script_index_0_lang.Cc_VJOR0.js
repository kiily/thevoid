function h(e){const t=m(e),a=new ArrayBuffer(t.length),r=new DataView(a);for(let n=0;n<a.byteLength;n++)r.setUint8(n,t.charCodeAt(n));return a}const _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function m(e){e.length%4===0&&(e=e.replace(/==?$/,""));let t="",a=0,r=0;for(let n=0;n<e.length;n++)a<<=6,a|=_.indexOf(e[n]),r+=6,r===24&&(t+=String.fromCharCode((a&16711680)>>16),t+=String.fromCharCode((a&65280)>>8),t+=String.fromCharCode(a&255),a=r=0);return r===12?(a>>=4,t+=String.fromCharCode(a)):r===18&&(a>>=2,t+=String.fromCharCode((a&65280)>>8),t+=String.fromCharCode(a&255)),t}const L=-1,b=-2,v=-3,D=-4,w=-5,U=-6;function C(e,t){return k(JSON.parse(e),t)}function k(e,t){if(typeof e=="number")return n(e,!0);if(!Array.isArray(e)||e.length===0)throw new Error("Invalid input");const a=e,r=Array(a.length);function n(s,f=!1){if(s===L)return;if(s===v)return NaN;if(s===D)return 1/0;if(s===w)return-1/0;if(s===U)return-0;if(f)throw new Error("Invalid input");if(s in r)return r[s];const o=a[s];if(!o||typeof o!="object")r[s]=o;else if(Array.isArray(o))if(typeof o[0]=="string"){const l=o[0],c=t?.[l];if(c)return r[s]=c(n(o[1]));switch(l){case"Date":r[s]=new Date(o[1]);break;case"Set":const i=new Set;r[s]=i;for(let d=1;d<o.length;d+=1)i.add(n(o[d]));break;case"Map":const u=new Map;r[s]=u;for(let d=1;d<o.length;d+=2)u.set(n(o[d]),n(o[d+1]));break;case"RegExp":r[s]=new RegExp(o[1],o[2]);break;case"Object":r[s]=Object(o[1]);break;case"BigInt":r[s]=BigInt(o[1]);break;case"null":const E=Object.create(null);r[s]=E;for(let d=1;d<o.length;d+=2)E[o[d]]=n(o[d+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const d=globalThis[l],A=o[1],g=h(A),T=new d(g);r[s]=T;break}case"ArrayBuffer":{const d=o[1],A=h(d);r[s]=A;break}default:throw new Error(`Unknown type ${l}`)}}else{const l=new Array(o.length);r[s]=l;for(let c=0;c<o.length;c+=1){const i=o[c];i!==b&&(l[c]=n(i))}}else{const l={};r[s]=l;for(const c in o){const i=o[c];l[c]=n(i)}}return r[s]}return n(0)}function P(e){return e.endsWith("/")?e:e+"/"}const O={actionName:"_action"},F=O,M=P,S={BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,CONTENT_TOO_LARGE:413,URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,MISDIRECTED_REQUEST:421,UNPROCESSABLE_CONTENT:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_EARLY:425,UPGRADE_REQUIRED:426,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,REQUEST_HEADER_FIELDS_TOO_LARGE:431,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,VARIANT_ALSO_NEGOTIATES:506,INSUFFICIENT_STORAGE:507,LOOP_DETECTED:508,NETWORK_AUTHENTICATION_REQUIRED:511},x=Object.entries(S).reduce((e,[t,a])=>({...e,[a]:t}),{});class y extends Error{type="AstroActionError";code="INTERNAL_SERVER_ERROR";status=500;constructor(t){super(t.message),this.code=t.code,this.status=y.codeToStatus(t.code),t.stack&&(this.stack=t.stack)}static codeToStatus(t){return S[t]}static statusToCode(t){return x[t]??"INTERNAL_SERVER_ERROR"}static fromJson(t){return $(t)?new Q(t.issues):B(t)?new y(t):new y({code:"INTERNAL_SERVER_ERROR"})}}function B(e){return typeof e=="object"&&e!=null&&"type"in e&&e.type==="AstroActionError"}function $(e){return typeof e=="object"&&e!=null&&"type"in e&&e.type==="AstroActionInputError"&&"issues"in e&&Array.isArray(e.issues)}class Q extends y{type="AstroActionInputError";issues;fields;constructor(t){super({message:`Failed to validate: ${JSON.stringify(t,null,2)}`,code:"BAD_REQUEST"}),this.issues=t,this.fields={};for(const a of t)if(a.path.length>0){const r=a.path[0].toString();this.fields[r]??=[],this.fields[r]?.push(a.message)}}}function p(e){return`?${new URLSearchParams({[O.actionName]:e}).toString()}`}function R(e){if(e.type==="error"){let t;try{t=JSON.parse(e.body)}catch{return{data:void 0,error:new y({message:e.body,code:"INTERNAL_SERVER_ERROR"})}}return{error:y.fromJson(t),data:void 0}}return e.type==="empty"?{data:void 0,error:void 0}:{data:C(e.body,{URL:t=>new URL(t)}),error:void 0}}const G="%2E";function I(e={},t=""){return new Proxy(e,{get(a,r){if(r in a||typeof r=="symbol")return a[r];const n=t+encodeURIComponent(r.toString()).replaceAll(".",G);function s(f){return N(f,n)}return Object.assign(s,{queryString:p(n),toString:()=>s.queryString,$$FORM_ACTION:function(){return{method:"POST",name:"_astroAction",action:"?"+new URLSearchParams(s.toString()).toString()}},async orThrow(f){const{data:o,error:l}=await N(f,n);if(l)throw l;return o}}),I(s,n+".")}})}function j(e){let t=`${"/".replace(/\/$/,"")}/_actions/${new URLSearchParams(e.toString()).get(F.actionName)}`;return t=M(t),t}async function N(e,t,a){const r=new Headers;r.set("Accept","application/json");let n=e;if(!(n instanceof FormData)){try{n=JSON.stringify(e)}catch(f){throw new y({code:"BAD_REQUEST",message:`Failed to serialize request body to JSON. Full error: ${f.message}`})}n?r.set("Content-Type","application/json"):r.set("Content-Length","0")}const s=await fetch(j({toString(){return p(t)}}),{method:"POST",body:n,headers:r});return s.status===204?R({type:"empty",status:204}):R({type:s.ok?"data":"error",body:await s.text()})}const V=I();document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('input[type="search"]').forEach(t=>{const a=t.closest(".search-container"),r=a?.querySelector(".search-results"),n=a?.querySelector(".search-loading"),s=a?.querySelector(".search-button");if(!r)return;let f,o="";const l=async c=>{if(c.length===0){r.classList.add("hidden");return}n&&n.classList.remove("hidden");try{const u=t.closest(".search-container")?.dataset.contentFilter||"all",{data:E,error:d}=await V.search({q:c,limit:12,contentFilter:u});if(n&&n.classList.add("hidden"),d){r.innerHTML='<div class="p-6 text-red-500 text-center">Search error</div>',r.classList.remove("hidden");return}if(E?.results?.length>0){const A=E.results.map(T=>`
							<a href="${T.item.url}" class="block p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 border-b border-gray-100 dark:border-gray-700 last:border-b-0 first:rounded-t-2xl last:rounded-b-2xl">
								<div class="font-semibold text-garden-primary dark:text-garden-dark-primary mb-1">${T.item.title}</div>
								<div class="text-sm text-garden-secondary dark:text-garden-dark-secondary line-clamp-2 mb-2">${T.item.description}</div>
								<div class="flex items-center justify-between">
									<div class="text-xs text-garden-accent dark:text-garden-dark-accent capitalize font-medium px-2 py-1 bg-garden-accent/10 dark:bg-garden-dark-accent/20 rounded-full">${T.item.type}</div>
								</div>
							</a>
						`).join(""),g=E.results.length>=10?`<div class="p-4 text-sm text-center text-garden-secondary dark:text-garden-dark-secondary border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 rounded-b-2xl">
								Showing ${E.results.length} of ${E.meta?.total||E.results.length} results
							   </div>`:"";r.innerHTML=A+g,r.classList.remove("hidden")}else{const A=u==="garden-only"?"garden posts":u==="projects-only"?"projects":"content";r.innerHTML=`<div class="p-6 text-garden-secondary dark:text-garden-dark-secondary text-center">No ${A} found for "${c}"</div>`,r.classList.remove("hidden")}}catch{n&&n.classList.add("hidden"),r.innerHTML='<div class="p-6 text-red-500 text-center">Search failed</div>',r.classList.remove("hidden")}};t.addEventListener("input",async c=>{const i=c.target;if(!i)return;const u=i.value.trim();o=u,clearTimeout(f),f=window.setTimeout(async()=>{u===o&&await l(u)},300)}),s?.addEventListener("click",async()=>{const i=t.value.trim();i&&await l(i)}),t.addEventListener("keydown",async c=>{const i=c,u=c.target;if(i.key==="Enter"){c.preventDefault();const E=u.value.trim();E&&await l(E)}else i.key==="Escape"&&(r.classList.add("hidden"),u.blur())}),document.addEventListener("click",c=>{const i=c.target;a?.contains(i)||r.classList.add("hidden")})})});
