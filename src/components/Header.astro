---
import { Image } from 'astro:assets';
import ThemeToggle from './ThemeToggle.astro';

const navItems = [
	{ label: 'About', href: '/#about' },
	{ label: 'Garden', href: '/#garden' },
	{ label: 'Projects', href: '/#projects' },
	{ label: 'Contact', href: '/#contact' },
];

const currentPath = Astro.url.pathname;
const isHomePage = currentPath === '/';
---

<header
	class="fixed w-full bg-garden-background/95 dark:bg-garden-dark-background/95 backdrop-blur-md z-50 border-b border-gray-200/50 dark:border-gray-800/50"
>
	<nav class="container mx-auto max-w-5xl px-6 md:px-8 py-4">
		<div class="flex items-center justify-between">
			<a
				href="/"
				class="text-lg font-semibold text-garden-primary dark:text-garden-dark-primary flex items-center gap-2.5 font-ui hover:opacity-70 transition-opacity"
			>
				<Image
					src="/void.svg"
					alt="The void logo"
					class="w-5 h-5"
					width={20}
					height={20}
					quality="high"
				/>
				The void
			</a>

			<div class="flex items-center gap-6">
				<ul class="hidden md:flex items-center gap-6">
					{
						navItems.map((item) => (
							<li>
								<a
									href={isHomePage ? item.href : `/${item.href.slice(1)}`}
									class="text-sm font-medium text-garden-secondary hover:text-garden-primary dark:text-garden-dark-secondary dark:hover:text-garden-dark-primary transition-colors font-ui"
								>
									{item.label}
								</a>
							</li>
						))
					}
				</ul>
				<ThemeToggle />
			</div>
		</div>
	</nav>
</header>

<script>
	// Handle navigation and smooth scrolling
	document.addEventListener('DOMContentLoaded', () => {
		const isHomePage = window.location.pathname === '/';
		const navLinks = document.querySelectorAll('header nav a[href*="#"]');

		navLinks.forEach((link) => {
			link.addEventListener('click', (e) => {
				const href = link.getAttribute('href');
				if (!href) return;

				// If we're on the home page and it's a hash link
				if (isHomePage && href.startsWith('#')) {
					e.preventDefault();
					const targetId = href.slice(1);
					const targetElement = document.getElementById(targetId);
					if (targetElement) {
						targetElement.scrollIntoView({ behavior: 'smooth' });
					}
				}
				// If we're not on the home page, redirect to home with hash
				else if (!isHomePage && href.includes('#')) {
					e.preventDefault();
					window.location.href = href;
				}
			});
		});

		// Handle hash in URL when coming from another page
		if (!isHomePage && window.location.hash) {
			const targetId = window.location.hash.slice(1);
			const targetElement = document.getElementById(targetId);
			if (targetElement) {
				setTimeout(() => {
					targetElement.scrollIntoView({ behavior: 'smooth' });
				}, 100);
			}
		}
	});
</script>
